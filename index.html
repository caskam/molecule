<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Molecule by testinfected</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Molecule</h1>
        <h2>A Rack inspired web micro-framework for easy and fun Java Web Development</h2>
        <a href="https://github.com/testinfected/molecule" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quick Start</h2>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">HelloWorld</span> {
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">main</span>(<span class="pl-k">String</span>[] <span class="pl-v">args</span>) <span class="pl-k">throws</span> <span class="pl-smi">IOException</span> {
        <span class="pl-smi">WebServer</span> server <span class="pl-k">=</span> <span class="pl-smi">WebServer</span><span class="pl-k">.</span>create();
        server<span class="pl-k">.</span>start((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> response<span class="pl-k">.</span>done(<span class="pl-s"><span class="pl-pds">"</span>Hello, World<span class="pl-pds">"</span></span>));
    }
}</pre></div>

<p>Access your application at:</p>

<p><code>http://localhost:8080</code></p>

<h2>
<a id="download" class="anchor" href="#download" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Download</h2>

<p>You can get the latest release version from Maven Central:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">dependency</span>&gt;
      &lt;<span class="pl-ent">groupId</span>&gt;com.vtence.molecule&lt;/<span class="pl-ent">groupId</span>&gt;
      &lt;<span class="pl-ent">artifactId</span>&gt;molecule&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;<span class="pl-ent">version</span>&gt;0.10&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre></div>

<p>If you want the development version, grab the latest snapshot from Sonatype snapshots repositories 
(<code>https://oss.sonatype.org/content/repositories/snapshots</code>):</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">dependency</span>&gt;
      &lt;<span class="pl-ent">groupId</span>&gt;com.vtence.molecule&lt;/<span class="pl-ent">groupId</span>&gt;
      &lt;<span class="pl-ent">artifactId</span>&gt;molecule&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;<span class="pl-ent">version</span>&gt;0.11-SNAPSHOT&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre></div>

<p>To use the default web server, you also need to add <a href="http://www.simpleframework.org">Simple</a> as a dependency:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">dependency</span>&gt;
      &lt;<span class="pl-ent">groupId</span>&gt;org.simpleframework&lt;/<span class="pl-ent">groupId</span>&gt;
      &lt;<span class="pl-ent">artifactId</span>&gt;simple-http&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;<span class="pl-ent">version</span>&gt;6.0.1&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre></div>

<h2>
<a id="want-to-start-with-some-code" class="anchor" href="#want-to-start-with-some-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Want to start with some code?</h2>

<p>Try out the following examples:</p>

<ul>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/helloworld/HelloWorldExample.java">Hello World</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/simple/SimpleExample.java">Rendering HTML</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/routing/RoutingExample.java">Dynamic Routes</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/files/StaticFilesExample.java">Static Files</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/rest/RESTExample.java">REST</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/async/AsyncExample.java">Asynchronous Processing</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/cookies/CookiesExample.java">Cookies</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/flash/FlashExample.java">Flash</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/locale/LocaleNegotiationExample.java">Locale Negotiation</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/multipart/MultipartExample.java">Multipart Forms</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/templating/TemplatingAndLayoutExample.java">View Templates and Layout</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/session/SessionExample.java">HTTP Sessions</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/multiapps/MultiAppsExample.java">Multiple Applications</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/filtering/FilteringExample.java">Filters</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/middleware/CustomMiddlewareExample.java">Creating a Custom Middleware</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/performance/CachingAndCompressionExample.java">Caching and Compression</a></li>
<li><a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/ssl/SSLExample.java">SSL</a></li>
<li><a href="https://github.com/testinfected/simple-petstore/blob/master/webapp/src/main/java/org/testinfected/petstore/PetStore.java">A Sample Application</a></li>
</ul>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h2>

<p>First thing first, you need a server to run your app:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">WebServer</span> server <span class="pl-k">=</span> <span class="pl-smi">WebServer</span><span class="pl-k">.</span>create();</pre></div>

<p>This will set the default web server, which is powered by <a href="http://www.simpleframework.org">Simple</a>, 
to run locally on port 8080.</p>

<p>To start the server, give it an app:</p>

<div class="highlight highlight-source-java"><pre>server<span class="pl-k">.</span>start((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> response<span class="pl-k">.</span>done(<span class="pl-s"><span class="pl-pds">"</span>Hello, World!<span class="pl-pds">"</span></span>));</pre></div>

<p>To stop the server, call the <em>stop</em> method:</p>

<div class="highlight highlight-source-java"><pre>server<span class="pl-k">.</span>stop()</pre></div>

<p>You can optionally specify the interface and port to bound to when creating the server, e.g. if you want to make your server globally available:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">WebServer</span> server <span class="pl-k">=</span> <span class="pl-smi">WebServer</span><span class="pl-k">.</span>create(<span class="pl-s"><span class="pl-pds">"</span>0.0.0.0<span class="pl-pds">"</span></span>, <span class="pl-c1">8088</span>);</pre></div>

<h2>
<a id="asynchronous-processing" class="anchor" href="#asynchronous-processing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Asynchronous Processing</h2>

<p>Molecule uses <a href="http://www.simpleframework.org">Simple</a> as a default webserver.
Both are fully asynchronous and non-blocking. This allows the server to scale to very high loads and handle as many concurrent connections as possible, even when depending on a high latency external resource.</p>

<p>What this means is you can serve your response content from a thread separate to the original servicing thread. For instance your application 
might need to wait for some remote process that takes some time to complete, such as an HTTP or SOAP request to an external server. You can simply 
call this external resource from a different thread, and complete the response when you get the result.</p>

<p>To tell the server that you're ready to serve the response, call the <em>done</em> method on the response.</p>

<p>Look at the <a href="https://github.com/testinfected/molecule/blob/master/src/test/java/examples/async/AsyncExample.java">Asynchronous example</a>
to see how to serve content from a separate thread.</p>

<h2>
<a id="routing" class="anchor" href="#routing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Routing</h2>

<p>Most modern webapps have nice URLs. Simple URLs are also easier to remember and more user friendly. </p>

<p>Molecule comes with a routing middleware that let you define your URL routes. </p>

<p>Routes let you map incoming requests to different applications based on the request verb and path. A route is composed
of a path pattern, an optional set of verbs to match, and an application endpoint: </p>

<div class="highlight highlight-source-java"><pre>server<span class="pl-k">.</span>start(<span class="pl-k">new</span> <span class="pl-smi">DynamicRoutes</span>() {{
    get(<span class="pl-s"><span class="pl-pds">"</span>/posts/:id<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
        <span class="pl-c">// retrieve a given post</span>
    });
    post(<span class="pl-s"><span class="pl-pds">"</span>/posts<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
        <span class="pl-c">// create a new post</span>
    }); 
    put(<span class="pl-s"><span class="pl-pds">"</span>/posts/:id<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
        <span class="pl-c">// update an existing post</span>
    });
    delete(<span class="pl-s"><span class="pl-pds">"</span>/posts/:id<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
        <span class="pl-c">// delete a post</span>
    }); 
    map(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
        <span class="pl-c">// show the home page</span>
    });
}});</pre></div>

<h3>
<a id="matching" class="anchor" href="#matching" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Matching</h3>

<p>Routes are matched in the order they are defined. If not defined route matches, the default behaviour is to 
render a 404 Not Found. This can be configured to pass the control to any default application.</p>

<p>By default, a route matches a single verb, specified by the method you use, i.e. <em>get</em>, <em>post</em>, <em>put</em>, <em>delete</em>.
That can be changed by providing the verbs as arguments to the <em>via</em> method:</p>

<div class="highlight highlight-source-java"><pre>map(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>via(<span class="pl-c1">GET</span>, <span class="pl-c1">HEAD</span>)<span class="pl-k">.</span>to((request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
    <span class="pl-c">// show the home page</span>
});</pre></div>

<p>If you don't provide any verbs, <em>map</em> will match on all verbs.</p>

<h3>
<a id="dynamic-parameters" class="anchor" href="#dynamic-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic Parameters</h3>

<p>Route patterns can be matched exactly - they are said to be static - or can include named parameters,
 which are then accessible as regular request parameters on the request object:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-c">// matches "GET /photos/18" and "GET /photos/25"</span>
<span class="pl-c">// request.parameter("id") is either '18' or '25'</span>
get(<span class="pl-s"><span class="pl-pds">"</span>/photos/:id<span class="pl-pds">"</span></span>, (request, response) <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
    response<span class="pl-k">.</span>done(<span class="pl-s"><span class="pl-pds">"</span>Photo #<span class="pl-pds">"</span></span> <span class="pl-k">+</span> request<span class="pl-k">.</span>parameter(<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>));
});</pre></div>

<h3>
<a id="custom-matching" class="anchor" href="#custom-matching" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Custom Matching</h3>

<p>You are not limited to the provided match patterns. You can easily implement your own matcher and decide exactly how to match an incoming url to an application.</p>

<p>To do this, use the route definition methods that accept a <em>Matcher</em> rather than a <em>String</em>.</p>

<h2>
<a id="working-with-the-request" class="anchor" href="#working-with-the-request" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Working with the Request</h2>

<h3>
<a id="request-object" class="anchor" href="#request-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Request Object</h3>

<h3>
<a id="attributes" class="anchor" href="#attributes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Attributes</h3>

<h2>
<a id="working-with-the-response" class="anchor" href="#working-with-the-response" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Working with the Response</h2>

<h3>
<a id="response-object" class="anchor" href="#response-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Response Object</h3>

<h3>
<a id="bodies" class="anchor" href="#bodies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Bodies</h3>

<h3>
<a id="redirection-and-errors" class="anchor" href="#redirection-and-errors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Redirection and Errors</h3>

<h2>
<a id="cookies" class="anchor" href="#cookies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cookies</h2>

<h2>
<a id="sessions" class="anchor" href="#sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sessions</h2>

<h2>
<a id="rendering-templates" class="anchor" href="#rendering-templates" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rendering Templates</h2>

<h2>
<a id="view-layouts" class="anchor" href="#view-layouts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>View Layouts</h2>

<h2>
<a id="testing" class="anchor" href="#testing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Testing</h2>

<h2>
<a id="middlewares" class="anchor" href="#middlewares" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Middlewares</h2>

<p>Middlewares are a way to enhance your application with optional building blocks, using a pipeline design. </p>

<p>They implement functionality you tend to need across all your applications,
but you don't want to build everytime. Things like <strong>access logging</strong>, <strong>authentication</strong>, 
<strong>compression</strong>, <strong>static files</strong>, <strong>routing</strong>, etc. </p>

<p>Being able to separate the processing of the request (and post-processing of the response) in different stages 
has several benefits:</p>

<ul>
<li>It separate concerns, which helps keep your design clean and application well-structured</li>
<li>It let you only include the functionality you need, so your server is as small and fast as possible </li>
<li>It let you plug in your own processing stages, to customize the behavior of your application</li>
<li>It let you reuse and share middlewares, as elemental building blocks of application behavior</li>
</ul>

<p>For example you could have the following separate stages of the pipeline doing:</p>

<ol>
<li>Capturing internal server errors to render a nice 500 page</li>
<li>Monitoring, logging accesses to the server</li>
<li>Authentication and authorisation, to control access to your applicatin</li>
<li>Caching, returning a cached result if request has already been processed recently</li>
<li>Compression, to reduce bandwith usage</li>
<li>Security, to prevent attacks such as CSRF</li>
<li>Processing, to actually process the request</li>
</ol>

<h3>
<a id="available-middlewares" class="anchor" href="#available-middlewares" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Available Middlewares</h3>

<p>Molecule comes with a number of middlewares (more are coming), that you can use to build your processing pipeline:</p>

<ul>
<li>Router (See <a href="#routing">Routing</a>)</li>
<li>Static Assets </li>
<li>File Server</li>
<li>Apache Common Logger</li>
<li>Apache Combined Logger</li>
<li>Cookies</li>
<li>Locale Negotiation</li>
<li>Compressor</li>
<li>ETag</li>
<li>Conditional Get</li>
<li>Connection Scope</li>
<li>Server Header</li>
<li>Date Header</li>
<li>Content-Length Header</li>
<li>Filter Map</li>
<li>URL Map</li>
<li>Cookie Session Tracker</li>
<li>Failsafe</li>
<li>Failure Monitor</li>
<li>Not Found</li>
<li>Http Method Override</li>
<li>Layout</li>
<li>Flash</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/testinfected/molecule/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/testinfected/molecule/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/testinfected/molecule"></a> is maintained by <a href="https://github.com/testinfected">testinfected</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-16545808-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
